# --- 1. البيئة الأساسية (Base Image) ---
# نستخدم صورة Node.js رسمية (إصدار 18-alpine).
# "alpine" هي نسخة خفيفة جداً من لينكس، تخلي صورتنا صغيرة وسريعة.
FROM node:18-alpine

# --- 2. إعداد مجلد العمل ---
# ننشئ مجلد داخل الكونتينر ليحتوي على كود التطبيق
WORKDIR /usr/src/app

# --- 3. نسخ ملفات المشروع ---
# ننسخ ملفات package.json و package-lock.json (إن وجد)
# هذا يسمح لـ Docker بتثبيت الاعتماديات بذكاء (caching)
COPY package*.json ./

# --- 4. تثبيت الاعتماديات ---
# نشغل "npm install" داخل الكونتينر
RUN npm install

# --- 5. نسخ كود التطبيق ---
# الآن ننسخ باقي ملفات التطبيق (مثل app.js)
COPY . .

# --- 6. فتح المنفذ (Expose Port) ---
# نفتح المنفذ 8080 (الذي يستخدمه تطبيقنا)
EXPOSE 8080

# --- 7. أمر التشغيل (Run Command) ---
# هذا هو الأمر الذي سيعمل عند تشغيل الكونتينر
CMD [ "node", "app.js" ]